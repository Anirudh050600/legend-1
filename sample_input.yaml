---
title: SampleTitle
service: SampleService
grafana_folder: SampleFolder
alert_channels: ["service-opsgenie"]
environment: Prod
description: Logging tool for everything deployed on kubernetes
references:
- deployment: https://github.com/grofers/kube-infra/tree/master/manifests/loki
- documentation: https://github.com/grafana/loki/tree/master/docs
- metrics_definition: https://github.com/grofers/kube-infra/tree/master/manifests/loki
tags:
- stage
- infra
components:
  s3:
    dimensions:
    - bucket_name: grofers-loki-prod
      filter_id: EntireBucket
    - bucket_name: retail-bulk-upload
      filter_id: EntireBucket
    panels:
    - title: (R) Request Count - WriteMY
      type: Graph
      description: TODO
      targets:
      - dimensions: {"BucketName": "grofers-loki-prod" ,"FilterId": "EntireBucket"}
        metric: PutRequests
        namespace: AWS/S3
        statistic: Sum
        alias: '{{ metric }}'
        ref_no: 1
      - dimensions: {"BucketName": "grofers-loki-prod" ,"FilterId": "EntireBucket"}
        metric: PostRequests
        namespace: AWS/S3
        statistic: Sum
        alias: '{{ metric }}'
        ref_no: 2
      alert_config:
        priority: P1
        message: 'Request Count - Write take actions like this 1. 2.'
        rule:
          for_duration: 1m
          evaluate_every: 10s
        condition_query:
          - OR,avg,1,now,5m,gt,20
          - OR,avg,2,now,5m,gt,30
    - title: (R) Request Count - Read/Write
      alert_config:
        priority: P2
        message: 'Request Count - Write take actions like this 1. 2.'
        rule:
          for_duration: 5m
          evaluate_every: 10s
        condition_query:
          - OR,avg,1,now,5m,gt,20

  systemcore_ec2:
    dimensions:
    - host: purchaseorder
  promtail:
    dimensions:
    - pod_name: promtail
  redis:
    dimensions:
      - job_name: po-redis-metrics
  celery:
    dimensions:
      - job_name: po-celery-metrics
